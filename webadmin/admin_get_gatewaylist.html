<%

function GetGatewayList()
	local xml = ""
	xml = xml.."<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\r\n"
	xml = xml.."<alldata>\r\n"
	for _,gateway in pairs(c_GetGatewayList()) do
		if type(gateway) == "table" then
			xml = xml.."<gatewaylist>\r\n"
			xml = xml.."<host><![CDATA["
			xml = xml..gateway["gateway_host"]
			xml = xml.."]]></host>"
			xml = xml.."<enable>"
			xml = xml..tostring(gateway["gateway_enable"])
			xml = xml.."</enable>"
			xml = xml.."<running>"
			xml = xml..tostring(gateway["gateway_running"])
			xml = xml.."</running>\r\n"
			xml = xml.."</gatewaylist>\r\n"
		end
	end
	xml = xml.."</alldata>\r\n"
	return xml
end

if _SESSION["logined"] ~= nil then
	setContentType("text/xml; charset=UTF-8")
	local liststr = GetGatewayList()
	print(liststr)
end
%>