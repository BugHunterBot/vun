<%
if _REMOTE_IP == "127.0.0.1" or _REMOTE_IP == "localhost" then
	setContentType("text/xml; charset=UTF-8")
	local xml = "<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\r\n<alldata>\r\n<listenerlist>\r\n"
	local domain = ""
	for _,domain in pairs(c_GetDomainList()) do
		local listenerlist = c_GetListenerList(domain)
		if listenerlist ~= nil then
			for _,listener in pairs(listenerlist) do
				if type(listener) == "table" then
					xml = xml.."<Listener>\r\n"
					xml = xml.."<Domain>"
					xml = xml..domain
					xml = xml.."</Domain>"
					xml = xml.."<Type>"
					xml = xml..listener["Type"]
					xml = xml.."</Type>"
					xml = xml.."<Ip_Address>"
					xml = xml..listener["Ip_Address"]
					xml = xml.."</Ip_Address>"
					xml = xml.."<Port>"
					xml = xml..listener["Port"]
					xml = xml.."</Port>"
					xml = xml.."<Is_Listening>"
					xml = xml..tostring(listener["Is_Listening"])
					xml = xml.."</Is_Listening>\r\n"
					xml = xml.."</Listener>\r\n"
				end
			end
		end
	end
	xml = xml.."</listenerlist>\r\n"
	xml = xml.."</alldata>\r\n"
	print(xml)
end
%>