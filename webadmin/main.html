<%
local all_lang = {"english","french","german","italian","dutch","portuguese","spanish","schinese","tchinese","japanese","czech","romanian","turkish","korean","polish"}
if _GET["lang"] ~= nil then
	for _,val in pairs(all_lang) do
		if _GET["lang"] == val then
			setcookie("admin_lang",val,2101702507)
			break
		end
	end

	if _COOKIE["admin_lang"] == nil then
		_COOKIE["admin_lang"] = "english"
	end
end

include("language.html")
if _SESSION["logined"] ~= nil then

local IpList = c_GetLocalIpList()
%>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>
Wing FTP Server - Web Administration
<%
local nType,strVersion,strUserName,strCopyNumber,strOS,nLeftDay = c_GetLicenseInfo()
if nType == LICENSE_TRIAL then
	print("(UNREGISTERED)")
elseif nType == LICENSE_EXPIRE then
	print("(EXPIRED)")
elseif nType == LICENSE_FAILED then
	print("(VIOLATED)")
end
%>
</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="pragma" content="no-cache" />
<meta http-equiv="cache-control" content="no-cache, must-revalidate" />
<link rel="Shortcut Icon" href="images/logo.ico" type="image/x-icon">
<style type="text/css">
<%if _COOKIE["admin_lang"] == "schinese" or _COOKIE["admin_lang"] == "tchinese" or _COOKIE["admin_lang"] == "japanese" then%>
body,td,span {font:12px/20px Verdana, Geneva, Arial, Helvetica, sans-serif;}
<%else%>
body,td,span {font:11px/20px Verdana, Geneva, Arial, Helvetica, sans-serif;}
<%end%>
body{
overflow: auto;
word-break:break-all;
}
img {border:0px;}
a:link,a:visited,a:active,a:hover{color: #000;text-decoration:none;}
td {line-height:24px;}

button{
border:none;background:none;padding:0;
margin:0;width:auto;overflow:visible;text-align:center;
white-space:nowrap;height:24px;line-height:24px;
cursor:pointer;
color:#000;
margin-left:2px;
margin-top:2px;
}
button span, button em{
display:block;height:24px;line-height:22px;margin:0;
}	
button span{
font-size:8pt;
padding-left:12px;
background:url("images/button_left.gif") no-repeat 0 0;
}
<%if _COOKIE["admin_lang"] == "schinese" or _COOKIE["admin_lang"] == "tchinese" or _COOKIE["admin_lang"] == "japanese" then%>
button em{
font-style:normal;padding-right:14px;
background:url("images/button.gif") no-repeat 101% 0;
}
<%else%>
button em{
font-style:normal;padding-right:10px;
background:url("images/button.gif") no-repeat 100% 0;
}
<%end%>
button:hover{
filter:alpha(opacity=60);
opacity:0.60;
color:#5488C9;
}
button span:hover{
filter:alpha(opacity=60);
opacity:0.60;
color:#5488C9;
}
.buttonhover{
filter:alpha(opacity=60);
opacity:0.60;
color:#5488C9;
}

</style>

<script language="javascript" src="include/common.js"></script>
<script language="javascript">
var IpList = "<%=IpList%>";
var IpListArray = IpList.split(",");
var selectdomain = "";
var last_dragoobj = 0;   
var last_width = 0;   
var	last_x = 0;
var newdomain = "";

var ajaxlock = false;
var xmlhttp,page,post;
xmlhttp = isIE ? new ActiveXObject('Microsoft.XMLHTTP'):new XMLHttpRequest();

function ajaxRequest(pagename,poststring,method)
{
	if(ajaxlock == false)
	{	
		delete xmlhttp;
		xmlhttp = isIE ? new ActiveXObject('Microsoft.XMLHTTP'):new XMLHttpRequest();

		ajaxlock = true;
		page = pagename;
		post = poststring;

		if(method == "GET")
			xmlhttp.open("GET",page+".html"+post);
		else
			xmlhttp.open("POST",page+".html");

		xmlhttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
		xmlhttp.onreadystatechange = ajaxResponse;
		if(method != "GET")
			xmlhttp.send(post);
		else
			xmlhttp.send("");
	}
}

function ajaxResponse()
{
	if (xmlhttp.readyState == 4)
	{
		ajaxlock = false;
		if (xmlhttp.status == 200)
		{
			try
			{
				switch(page)
				{
					case 'admin_create_domain':	CreateDomain_Result();break;
					case 'admin_delete_domain':	DeleteDomain_Result();break;
					case 'admin_startstop_domain':	window.location.reload();break;
					case 'admin_startstop_server':	window.location.reload();break;
				}
			}
			catch(e)
			{
				alert("<%=LANG['error_ajax']%>");
			}
		}
		else
		{
			alert("<%=LANG['error_ajax']%>");
		}
	}
}

function gotoUrl(url, newTab) 
{
	var isBrowserIE = navigator.userAgent.indexOf('MSIE')==-1? 0:1;
	if (isBrowserIE) 
	{
		try
		{
			if (newTab) 
			{
				var referLink = document.createElement("a");
				referLink.href = url;
				referLink.target = "_blank";
				document.body.appendChild(referLink);
				referLink.click();
				document.body.removeChild(referLink);
			} 
			else
			{
				var referLink = document.createElement("a");
				referLink.href = url;
				document.body.appendChild(referLink);
				referLink.click();
			}
		}
		catch(e)
		{
			window.location = url;
		}
	} 
	else
	{
		if (newTab) 
		{
			window.open(url, "_blank");
		}
		else 
		{
			window.location = url;
		}
	}
}

function frame_dragStart(obj)
{   
	var evt = getEvent();
	last_dragoobj = obj;   
	last_width = $("left").clientWidth-1;
	last_x = evt.clientX;
	
	if(window.addEventListener)
	{
		evt.preventDefault();
		window.addEventListener("mousemove",frame_dragMove,true);
		window.addEventListener("mouseup",frame_dragEnd,true);
		$("left").contentWindow.addEventListener("mousemove",top.frame_dragMove,true);
		$("left").contentWindow.addEventListener("mouseup",top.frame_dragEnd,true);
		$("main").contentWindow.addEventListener("mousemove",top.frame_dragMove2,true);
		$("main").contentWindow.addEventListener("mouseup",top.frame_dragEnd,true);
	}
	else
	{
		last_dragoobj.setCapture();
		last_dragoobj.attachEvent("onmousemove",function(){
			if(last_dragoobj)
			{   
				var evt = getEvent();
				var tempWidth = last_width + evt.clientX - last_x;   
				if(tempWidth<240) tempWidth = 240;
				if(tempWidth>360) tempWidth = 360;
				$("left").style.width = tempWidth+"px";   
			}   
		});
		last_dragoobj.attachEvent("onmouseup",function(){
			if(last_dragoobj)
			{
				last_dragoobj.releaseCapture();
				last_dragoobj = 0;

				setCookie("leftwidth", $("left").style.width);

			}
		});
	}
}   

function frame_dragMove(evt)
{
	if(last_dragoobj)
	{
		var tempWidth = last_width + evt.clientX - last_x;   
		if(tempWidth<240) tempWidth = 240;
		if(tempWidth>360) tempWidth = 360;
		$("left").style.width = tempWidth+"px"; 
	} 
}

function frame_dragMove2(evt)
{
	if(last_dragoobj)
	{
		var tempWidth = last_width + $("left").clientWidth+ evt.clientX - last_x;
		if(tempWidth<240) tempWidth = 240;
		if(tempWidth>360) tempWidth = 360;
		$("left").style.width = tempWidth+"px"; 
	} 
}

function frame_dragEnd()
{
	if(last_dragoobj) last_dragoobj = null;
	window.removeEventListener('mousemove',frame_dragMove,true); 
	window.removeEventListener('mouseup',frame_dragEnd,true); 
	$("left").contentWindow.removeEventListener('mousemove',top.frame_dragMove,true); 
	$("left").contentWindow.removeEventListener('mouseup',top.frame_dragEnd,true); 
	$("main").contentWindow.removeEventListener('mousemove',top.frame_dragMove2,true); 
	$("main").contentWindow.removeEventListener('mouseup',top.frame_dragEnd,true);

	setCookie("leftwidth", $("left").style.width);
}


function CreateDomain()
{
	var strIpList = "";
	for(var i=0;i<IpListArray.length;i++)
	{
		strIpList += "<option value='"+IpListArray[i]+"'>"+IpListArray[i]+"</option>";
	}
	showMessagebox("<%=LANG['str_createdomain']%>","<table width='100%' height='100%' border='0' cellpadding='2' cellspacing='2' style='background-color:#E6E6E6;' align='left'><tr align=left><td width=10 height=35>&nbsp;</td><td width=125><%=LANG['str_domianname']%>:</td><td><input type='text' style='width:210px' id='domainname' maxlength='30'></td></tr><tr align=left><td width=10>&nbsp;</td><td><%=LANG['str_bindipaddr']%>:</td><td><select id='bindaddress' style='width:130px'>"+strIpList+"</select>(<%=LANG['str_listeneraddr_tip']%>)</td></tr><tr align=left><td width=10>&nbsp;</td><td><input type='checkbox' id='ftp_port_check' checked onclick='CheckPort(1);'> FTP <%=LANG['str_port']%>:</td><td><input type='text' style='width:100px' id='ftp_port' value='21'></td></tr><tr align=left><td width=10>&nbsp;</td><td><input type='checkbox' id='ftps_port_check' checked onclick='CheckPort(2);'> FTPS <%=LANG['str_port']%>:</td><td><input type='text' style='width:100px' id='ftps_port' value='990'></td></tr><tr align=left><td width=10>&nbsp;</td><td><input type='checkbox' id='http_port_check' checked onclick='CheckPort(3);'> HTTP <%=LANG['str_port']%>:</td><td><input type='text' style='width:100px' id='http_port' value='80'></td></tr><tr align=left><td width=10>&nbsp;</td><td><input type='checkbox' id='https_port_check' checked onclick='CheckPort(4);'> HTTPS <%=LANG['str_port']%>:</td><td><input type='text' style='width:100px' id='https_port' value='443'></td></tr><tr align=left><td width=10>&nbsp;</td><td><input type='checkbox' id='ssh_port_check' checked onclick='CheckPort(5);'> SFTP <%=LANG['str_port']%>:</td><td><input type='text' style='width:100px' id='ssh_port' value='22'></td></tr><tr><td colspan=3 height=10></td></tr><tr><td colspan=3 style='padding:10px;'><button id='btn_submit' type='submit' onclick='return CreateDomain_Submit();' class='button1'><span><em><%=LANG['button_submit']%></em></span></button>&nbsp;<button id='btn_cancel' onclick='top.closewindow();' class='button1'><span><em><%=LANG['button_cancel']%></em></span></button></td></tr></table>",null,420,320);
	top.$("domainname").focus();

	top.$("btn_submit").onclick = function(){return CreateDomain_Submit();};
	top.$("btn_cancel").onclick = function(){top.closewindow();};
}

function CheckPort(value)
{
	if(value == 1)
	{
		$("ftp_port").disabled = ($("ftp_port_check").checked ? false : true);
	}
	else if(value == 2)
	{
		$("ftps_port").disabled = ($("ftps_port_check").checked ? false : true);
	}
	else if(value == 3)
	{
		$("http_port").disabled = ($("http_port_check").checked ? false : true);
	}
	else if(value == 4)
	{
		$("https_port").disabled = ($("https_port_check").checked ? false : true);
	}
	else if(value == 5)
	{
		$("ssh_port").disabled = ($("ssh_port_check").checked ? false : true);
	}
}

function CreateDomain_Submit()
{
	var domain = encodeURIComponent(htmldecode(top.$("domainname").value));
	newdomain = domain;
	var bindaddress = htmldecode(top.$("bindaddress").value);
	var ftp_port = parseInt(top.$("ftp_port").value);
	var ftps_port = parseInt(top.$("ftps_port").value);
	var http_port = parseInt(top.$("http_port").value);
	var https_port = parseInt(top.$("https_port").value);
	var ssh_port = parseInt(top.$("ssh_port").value);
	if(domain == "" || top.$("domainname").value.search(/[\\\/\<\>\:\?\"\'\|\[\]\{\}\*\,\&]/i) != -1)
	{
		alert("<%=LANG['str_invalid_domainname']%>");
		top.$("domainname").focus();
		return false;
	}
	if(top.$("ftp_port_check").checked && (isNaN(ftp_port) || ftp_port <= 0 || ftp_port > 65535))
	{
		alert("<%=LANG['str_invalid_port']%>");
		top.$("ftp_port").focus();
		return false;
	}
	if(top.$("ftps_port_check").checked && (isNaN(ftps_port) || ftps_port <= 0 || ftps_port > 65535))
	{
		alert("<%=LANG['str_invalid_port']%>");
		top.$("ftps_port").focus();
		return false;
	}
	if(top.$("http_port_check").checked && (isNaN(http_port) || http_port <= 0 || http_port > 65535))
	{
		alert("<%=LANG['str_invalid_port']%>");
		top.$("http_port").focus();
		return false;
	}
	if(top.$("https_port_check").checked && (isNaN(https_port) || https_port <= 0 || https_port > 65535))
	{
		alert("<%=LANG['str_invalid_port']%>");
		top.$("https_port").focus();
		return false;
	}
	if(top.$("ssh_port_check").checked && (isNaN(ssh_port) || ssh_port <= 0 || ssh_port > 65535))
	{
		alert("<%=LANG['str_invalid_port']%>");
		top.$("ssh_port").focus();
		return false;
	}
	if(top.$("ftp_port_check").checked == false) ftp_port=-1;
	if(top.$("ftps_port_check").checked == false) ftps_port=-1;
	if(top.$("http_port_check").checked == false) http_port=-1;
	if(top.$("https_port_check").checked == false) https_port=-1;
	if(top.$("ssh_port_check").checked == false) ssh_port=-1;

	ajaxRequest("admin_create_domain","domain="+domain+"&bindaddress="+bindaddress+"&ftp_port="+ftp_port+"&ftps_port="+ftps_port+"&http_port="+http_port+"&https_port="+https_port+"&ssh_port="+ssh_port);
	return true;
}

function CreateDomain_Result()
{
	var result = xmlhttp.responseText;
	if(result == "1" || result == 1)
	{
		if(confirm("<%=LANG['str_addnewuser_tip']%>"))
		{
			var frametag = new Date().getTime();
			showMessagebox("<%=LANG['str_adduser']%>","<iframe src='admin_adduser_form.html?domain="+newdomain+"&seeds=" + Math.random() +"' width=480 height=280 border=0 frameborder=0 id='add"+frametag+"'></iframe>",callback_return,480,280);
		}
		else
		{
			window.location.reload();
		}
	}
	else if(result == "2" || result == 2)
	{
		alert("<%=LANG['str_existed_domainname']%>");
	}
	else
	{
		alert("<%=LANG['str_createdomain_fail']%>");
	}
	newdomain = "";
}

function callback_return(value)
{
	window.location.reload();
	return true;
}

function DeleteDomain(domain)
{
	if(confirm("<%=LANG['str_deldomain_tip']%>("+domain+")?"))
	{
		ajaxRequest("admin_delete_domain","domain="+encodeURIComponent(domain));
	}
}

function DeleteDomain_Result()
{
	var result = xmlhttp.responseText;
	if(result == "0")
	{
		alert("<%=LANG['str_deldomain_fail']%>");
	}
	else
	{
		//alert("<%=LANG['str_deldomain_ok']%>");
		window.location.reload();
	}
}

function StartDomain(domain)
{
	ajaxRequest("admin_startstop_domain","domain="+encodeURIComponent(domain));
}

function StopDomain(domain)
{
	showMessagebox("<%=LANG['str_stopdomain']%>","<table width='100%' height='100%' border='0' cellpadding='2' cellspacing='0' style='background-color:#E6E6E6;'><tr><td width='360' align='left' style='padding-left:10px;padding-top:10px;background-color: #FFF;'><img src='images/vista_warning.gif'> <%=LANG['str_stopdomain_tip']%><br><br></td></tr><tr><td height=30 align=left><input type='radio' name='stopway' value='0' checked><%=LANG['str_stopdomain_tip1']%></td></tr><tr><td height=30 align=left><input type='radio' name='stopway' value='1'><%=LANG['str_stopdomain_tip2']%></td></tr><tr><td height=30 align=left><input type='radio' name='stopway' value='2'><%=LANG['str_stopdomain_tip3']%></td></tr><tr><td height=50><button id='btn_submit' type='submit' onclick='return StopDomain_submit(\""+domain+"\")' class='button1'><span><em><%=LANG['button_submit']%></em></span></button>&nbsp;<button id='btn_cancel' onclick='top.closewindow();' class='button1'><span><em><%=LANG['button_cancel']%></em></span></button></td></tr></table>",null,400,240);

	top.$("btn_submit").onclick = function(){return StopDomain_submit(domain);};
	top.$("btn_cancel").onclick = function(){top.closewindow();};
}

function StopDomain_submit(domain)
{
    var radios = document.getElementsByName("stopway");
    var stopway = 0;
    for(var i=0;i<radios.length;i++)
	{
        if(radios[i].checked)
		{ 
            stopway = radios[i].value; 
            break; 
        } 
    }

	ajaxRequest("admin_startstop_domain","domain="+encodeURIComponent(domain)+"&stop="+stopway);
}

function StartServer()
{
	ajaxRequest("admin_startstop_server","");
}

function StopServer()
{
	if(confirm("<%=LANG['str_stopserver_tip']%>"))
		ajaxRequest("admin_startstop_server","stop=1");
}

function adminLogout()
{
	if(confirm("<%=LANG['str_logout_tip']%>"))
	{
		//window.location = "admin_logout.html?r="+Math.random();
		gotoUrl("admin_logout.html?r="+Math.random());
	}
}

function adminHelp()
{
	//window.open("help/english/index.html","_blank");
	gotoUrl("help/english/index.html", true);
}

function gotoRegister()
{
	top.closewindow();
	frames['main'].location = "admin_license.html";
	return false;
}

function gotoPurchase()
{
<%
local purchase_url = "https://www.wftpserver.com/renew.php?product=3067198"
if nType == LICENSE_STANDARD then
	purchase_url = "https://www.wftpserver.com/renew.php?product=3067198"
elseif nType == LICENSE_SECURE then
	purchase_url = "https://www.wftpserver.com/renew.php?product=3067204"
elseif nType == LICENSE_CORPORATE then
	purchase_url = "https://www.wftpserver.com/renew.php?product=3067206"
end

local copy_num = "1"
if strCopyNumber == "Site License" then
	copy_num = "15"
else
	copy_num = string.sub(strCopyNumber, 1, 1)
end

purchase_url = purchase_url.."&quantity="..copy_num.."&company="..urlencode(strUserName)
%>
	top.closewindow();
	//window.open("<%=purchase_url%>","_blank");
	gotoUrl("<%=purchase_url%>", true);
	return false;
}

function upgradeTip()
{
	showMessagebox("<%=LANG['str_license_info']%>","<table width='100%' height='100%' border='0' cellpadding='0' cellspacing='0' style='background-color:#E6E6E6;padding:8px;'><tr><td align=left><div style='clear:none; word-break:keep-all;'><div style='float: left;'><img src='images/vista_warning.gif' align='absmiddle'>&nbsp;&nbsp;</div><%=LANG['str_upgrade_tip']%></div></td></tr><tr><td><button id='btn_submit' type='submit' onclick='top.gotoPurchase();' class='button1'><span><em><%=LANG['button_submit']%></em></span></button>&nbsp;<button id='btn_cancel' onclick='top.closewindow();' class='button1'><span><em><%=LANG['button_cancel']%></em></span></button></td></tr></table>",null,380,240);
}

function changeFrameHeight(height)
{
	try
	{
		var oldheight = height || $("main").height;
		var newheight = document.documentElement.clientHeight;
		if (document.body.clientHeight > document.documentElement.clientHeight)
		{
			newheight = document.body.clientHeight;
		}
		$("left").height = newheight - 120;
		if($("left").height < 530) $("left").height = 530;
		$("main").height = newheight - 120;
	}
	catch(e)
	{
	}

	try
	{
		var listview_div = $("main").contentWindow.document.getElementById("listview_div");
		if(listview_div != null)
		{
			var divheight = parseInt(listview_div.style.height.split("px")[0]) + ($("main").height - oldheight);
			if(divheight < 420) divheight = 420;
			listview_div.style.height = divheight + "px";
		}
	}
	catch(e)
	{
	}
}

window.onresize=function()
{  
     changeFrameHeight();
}

setInterval("keeplive()", 1000*300);
</script>
</head>
<body bgcolor="#DAE9FC" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<script language="javascript">
	if(isIpad)
	{
		document.write("<div style='height:0px;'><div style='background-color:#DAE9FC; width:98%; height:1500px; overflow:auto; overflow-x:hidden;'><table width='100%' border='0' style='table-layout:fixed; height:1550px;'></table></div></div>");
	}
</script>

<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0" align="center">
  <tr>
    <td height="100%" style="padding:5px;"><table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
        <tr> 
          <td height="100%" valign="top" bgcolor="#FFFFFF"><table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
              <tr> 
                <td height="66" background="images/top_bg2.gif"> 
                  <table width="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr> 
                      <td width="13"><img src="images/coner_left2.gif" width="13" height="66"></td>
                      <td height="66" valign="middle">
						<table width="100%" border="0" cellspacing="0" cellpadding="0">
                          <tr>
                            <td><img src="images/logo.png" style="margin-left:10px; margin-top:8px;"></td>
                            <td align="right">
							<table border="0" cellspacing="0" cellpadding="0" style="margin-top:12px;">
                                <tr>
								<%
								if nType == LICENSE_TRIAL then
									print("<td style='color:#000;font-weight:bold;'>(UNREGISTERED COPY)</td><td width='20'>&nbsp;</td>")
								elseif nType == LICENSE_EXPIRE then
									print("<td style='color:#000;font-weight:bold;'>(TRIAL IS EXPIRED)</td><td width='20'>&nbsp;</td>")
								elseif nType == LICENSE_FAILED then
									print("<td style='color:#000;font-weight:bold;'>(VIOLATED LICENSE)</td><td width='20'>&nbsp;</td>")
								end
								%>
								<% if _SESSION["admin_readonly"] ~= nil and  _SESSION["admin_readonly"] == 1 then %>
								  <td>[<%=LANG["str_readonly_admin"]%>]</td>
								  <td width="30">&nbsp;</td>
								<% end %>
                                  <td><img src="images/ico_help.png" style="cursor:pointer;" onclick="adminHelp();"></td>
                                  <td style="color:#4C4C4C; cursor:pointer; font-size:9pt; padding-left:4px;" onclick="adminHelp();"><b><%=LANG["button_help"]%></b></td>
								  <td width="25">&nbsp;</td>
                                  <td><img src="images/ico_quit.png" style="cursor:pointer;" onclick="adminLogout();"></td>
                                  <td style="color:#4C4C4C; cursor:pointer; font-size:9pt; padding-left:4px;" onclick="adminLogout();"><b><%=LANG["button_logout"]%></b></td>
								  <td width="25">&nbsp;</td>
                                </tr>
                              </table>
                            </td>
                          </tr>
                        </table></td>
                      <td width="13"><img src="images/coner_right2.gif" width="13" height="66"></td>
                    </tr>
                  </table></td>
              </tr>
              <tr> 
                <td height="100%"> <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
                    <tr> 
                      <td width="13" style="background:url(images/left.gif) repeat-y;"><div style="width:13px;"></div></td>
                      <td height="100%"> 
                        <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
                          <tr> 
                            <td width="240" height="100%" style="padding-top:5px;padding-left:5px;">
                              <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
                                <tr valign="top">
                                  <td height="100%">
								  <iframe src="admin_left.html" scrolling="auto" id="left" name="left" width="240" height="530" border="0" frameborder="0"></iframe>
								  </td>
                                </tr>
                              </table></td>
                            <td id="dragline" style="cursor:e-resize;background:url(images/line_bg.gif) repeat-y;" onmousedown="frame_dragStart(this);"><div style="width:3px;"></div></td>
                            <td width="100%" height="100%" style="padding-top:0px; background-color:#E6E6E6;">
                              <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
                                <tr valign="top">
                                  <td height="100%">
								  <iframe src="admin_domainlist.html" scrolling="auto" id="main" name="main" width="100%" height="535" onload="changeFrameHeight(535)" border="0" frameborder="0"></iframe>
								  </td>
                                </tr>
                              </table>
                               </td>
                          </tr>
                        </table> </td>
                      <td width="7" style="background:url(images/right.gif) repeat-y;"><div style="width:7px;"></div></td>
                    </tr>
                  </table></td>
              </tr>
            </table></td>
        </tr>
        <tr>
          <td height="12" background="images/bottom_bg.gif" bgcolor="#CCCCCC">
			<table width="100%" border="0" cellspacing="0" cellpadding="0">
              <tr> 
                <td width="13" valign="top"><img src="images/coner_left1.gif" width="13" height="12"></td>
                <td width="100%" valign="top"></td>
                <td width="13" valign="top"><img src="images/coner_right1.gif" width="13" height="12"></td>
              </tr>
            </table></td>
        </tr>
		<tr> 
		<td align="center">
		  <a href="https://www.wftpserver.com/" target="_blank">Wing FTP Server</a> ©2003-2025 <b>wftpserver.com</b> All Rights Reserved
		</td>
		</tr>
      </table>
      
    </td>
  </tr>
</table>
</body>
</html>

<script language="javascript">

if(getCookie("leftwidth") != null && getCookie("leftwidth") != "")
{
	$("left").style.width = getCookie("leftwidth");
}

</script>
<% 
else
	print("<meta http-equiv='Content-Type' content='text/html; charset=utf-8'>")
	print("<script>top.location='admin_login.html';</script>")
end 
%>

<noscript><center><H2><%=LANG["error_nojavascript"]%></H2></center></noscript>