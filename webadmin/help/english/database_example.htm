<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head>
   <title>Advanced Features &gt; Database Example</title>
   <meta name="generator" content="Help & Manual">
   <meta name="keywords" content="Database Example">
   <meta name="description" content="Database Example">
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

   <!-- This line forces IE8 into IE7 mode, safer until IE8 is better known -->
   <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />

   <link type="text/css" href="default.css" rel="stylesheet">
   <link type="text/css" href="custom.css" rel="stylesheet">
   <script type="text/javascript" src="nsh.js"></script>

<script type="text/javascript">   
// Toggle Toggler 

var toggleCount=false;
var switchState;

function toggleToggles() {

    if (!toggleCount) {
     toggleCount = true;
     HMToggleExpandAll(true);
     switchState = true;
     }
   
     else if (switchState) {
        HMToggleExpandAll(false);
        switchState = false;
        }
        
     else  {
        HMToggleExpandAll(true);
        switchState = true;
        } 
    }
</script>
   
<!-- non-scrolling headers for CHM and browser-based help, local styles-->
<style TYPE="text/css" media="screen"> 
   body {    
      margin:0; 
      padding:0; 
      overflow: auto; 
      background: #FFFFFF; 
   } 
   #idheader { 
      width:100%; 
      height:auto; 
      padding: 0; 
      margin: 0; 
} 
    #idheaderbg  {
    background: #6F6F6F; 
}

   #callout-table, #overview-table {display:block; position:relative; top:0; left:0;}
   #callout-icon {display:block; position:absolute; top:-11px; left:-11px;}
   #callout-icon-flag {display:block; position:absolute; top:-11px; left:-8px;}
   #callout-table a {text-decoration: none; color: blue;}
   #callout-table a:visited {text-decoration: none; color: blue;}
   #overview-table a {text-decoration: none; color: black;}
   #overview-table a:visited {text-decoration: none; color: black;}
   #callout-table a:hover, #overview-table a:hover {text-decoration: underline;}
   </style>
   
<style TYPE="text/css" MEDIA="print">
<!--
/* Hide navigation links and add space between header
     and text in the printed version. Not valid for eBooks. */
#idnav { display:none;	 }
.topichead { padding: 5px 5px 20px 5px; }
-->
</style>   
<script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="index.html?database_example.htm"; }
  else { parent.quicksync('a6.5'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head>
<body onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>
<!--ZOOMSTOP-->

<div id="idheader">
<div id="idheaderbg">
<table width="100%" border="0" cellspacing="0" cellpadding="0" 
       style="margin: 0px; background: url(header_bg.jpg);">

  <tr valign="bottom">
    <td align="left" valign="bottom" class="topichead">
   <p class="crumbs" id="idnav"><b>Navigation:</b>&nbsp;
   
   Advanced Features&nbsp;&gt;</p>
   <p class="p_Heading1"><span class="f_Heading1">Database Example</span></p>

    </td>
    <td align="right" width="120" valign="middle" class="topichead" id="idnav">
    
     <a href="database.htm"
        onmouseover="document.images.prev.src='btn_prev_h.gif'" 
        onmouseout="document.images.prev.src='btn_prev_n.gif'"
        ><img name=prev src="btn_prev_n.gif" border=0 alt="Previous page"
        ></a><a href="uoeoeia.htm"
        onmouseover="document.images.main.src='btn_home_h.gif'" 
        onmouseout="document.images.main.src='btn_home_n.gif'"><img name=main src="btn_home_n.gif" border=0 alt="Return to chapter overview"
        ></a><img src="btn_next_d.gif" border="0">
    </td>
  </tr>
  <tr><td colspan="2" style="height: 3px; background: url(header_bg_shadow.gif)"></td></tr>
</table>
</div>

<!-- The following code displays Expand All/Collapse All links  below the header in topics containing toggles -->
  

</div>  



<div id="idcontent"><div id="innerdiv"> 
<!--ZOOMRESTART-->
<p>Here is an example for creating FTP accounts in <a href="http://www.phpbb.com/" target="_blank" class="weblink">PHPBB</a> that every user registered in the forum can have an FTP account with his username and password, and the user data is stored via Mysql database, with which you can easily modify some user data fields by yourself, such as the 'expire time', 'upload quota', 'upload speed'...check out <a href="database.htm">database schema reference</a>, if necessary.</p>
<p>In this example, we use PHPBB version 3.0, and you would look for, in the source file "includes/ucp/ucp_register.php", the code:</p>
<p>&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExample" style="color: #008080;">$user_id</span><span class="f_CodeExample" style="color: #000000;">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">=</span><span class="f_CodeExample" style="color: #000000;">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">user_add(</span><span class="f_CodeExample" style="color: #008080;">$user_row</span><span class="f_CodeExample" style="color: #ff0000;">,</span><span class="f_CodeExample" style="color: #000000;">&nbsp;</span><span class="f_CodeExample" style="color: #008080;">$cp_data</span><span class="f_CodeExample" style="color: #ff0000;">);</span></p>
<p style="white-space: nowrap;"><span style="color: #000000;">&nbsp;</span></p>
<p style="white-space: nowrap;">then&nbsp;add&nbsp;the&nbsp;codes&nbsp;below&nbsp;directly&nbsp;after&nbsp;it.</p>
<p style="white-space: nowrap;"><span style="color: #000000;">&nbsp;</span></p>
<p class="p_CodeExample" style="white-space: normal;"><span class="f_CodeExample" style="font-style: italic; color: #008000;">//Wing FTP Server MOD start</span></p>
<p class="p_CodeExample" style="white-space: normal;"><span class="f_CodeExample" style="color: #008080;">$ftp_dbname</span><span class="f_CodeExample" style="color: #000000;"> </span><span class="f_CodeExample" style="color: #ff0000;">=</span><span class="f_CodeExample" style="color: #000000;"> </span><span class="f_CodeExample" style="color: #0000ff;">"wftp_database"</span><span class="f_CodeExample" style="color: #ff0000;">;</span><span class="f_CodeExample" style="color: #000000;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span><span class="f_CodeExample" style="font-style: italic; color: #008000;">//Wing FTP Server's mysql database name, assume in the same server.</span></p>
<p class="p_CodeExample" style="white-space: normal;"><span class="f_CodeExample" style="color: #008080;">$ftp_domain_name</span><span class="f_CodeExample" style="color: #000000;"> </span><span class="f_CodeExample" style="color: #ff0000;">=</span><span class="f_CodeExample" style="color: #000000;"> </span><span class="f_CodeExample" style="color: #0000ff;">"default"</span><span class="f_CodeExample" style="color: #ff0000;">;</span><span class="f_CodeExample" style="color: #000000;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="f_CodeExample" style="font-style: italic; color: #008000;">//ftp's domain name.</span></p>
<p class="p_CodeExample" style="white-space: normal;"><span class="f_CodeExample" style="color: #008080;">$ftp_dirpath</span><span class="f_CodeExample" style="color: #000000;"> </span><span class="f_CodeExample" style="color: #ff0000;">=</span><span class="f_CodeExample" style="color: #000000;"> </span><span class="f_CodeExample" style="color: #0000ff;">"D:/ftp_data/"</span><span class="f_CodeExample" style="color: #ff0000;">.</span><span class="f_CodeExample" style="color: #008080;">$data</span><span class="f_CodeExample" style="color: #ff0000;">[</span><span class="f_CodeExample" style="color: #0000ff;">'username'</span><span class="f_CodeExample" style="color: #ff0000;">];</span><span class="f_CodeExample" style="font-style: italic; color: #008000;">//user's directory path</span></p>
<p class="p_CodeExample" style="white-space: normal;"><span class="f_CodeExample" style="color: #008080;">$ftp_upload_limit</span><span class="f_CodeExample" style="color: #000000;"> </span><span class="f_CodeExample" style="color: #ff0000;">=</span><span class="f_CodeExample" style="color: #000000;"> </span><span class="f_CodeExample" style="font-weight: bold; color: #0000ff;">TRUE</span><span class="f_CodeExample" style="color: #ff0000;">;</span><span class="f_CodeExample" style="color: #000000;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="f_CodeExample" style="font-style: italic; color: #008000;">//whether to limit the quota size</span></p>
<p class="p_CodeExample" style="white-space: normal;"><span class="f_CodeExample" style="color: #008080;">$ftp_maxuoload_size</span><span class="f_CodeExample" style="color: #000000;"> </span><span class="f_CodeExample" style="color: #ff0000;">=</span><span class="f_CodeExample" style="color: #000000;"> </span><span class="f_CodeExample" style="color: #800080;">1024</span><span class="f_CodeExample" style="color: #ff0000;">*</span><span class="f_CodeExample" style="color: #800080;">1024</span><span class="f_CodeExample" style="color: #ff0000;">*</span><span class="f_CodeExample" style="color: #800080;">100</span><span class="f_CodeExample" style="color: #ff0000;">;</span><span class="f_CodeExample" style="color: #000000;"> &nbsp; &nbsp; &nbsp; &nbsp;  </span><span class="f_CodeExample" style="font-style: italic; color: #008000;">//if $ftp_upload_limit = TRUE, this value means the max quota bytes.</span></p>
<p class="p_CodeExample" style="white-space: normal;"><span class="f_CodeExample" style="color: #008080;">$db</span><span class="f_CodeExample" style="color: #ff0000;">-&gt;sql_query(</span><span class="f_CodeExample" style="color: #0000ff;">"USE "</span><span class="f_CodeExample" style="color: #ff0000;">.</span><span class="f_CodeExample" style="color: #008080;">$ftp_dbname</span><span class="f_CodeExample" style="color: #ff0000;">.</span><span class="f_CodeExample" style="color: #0000ff;">";"</span><span class="f_CodeExample" style="color: #ff0000;">);</span></p>
<p class="p_CodeExample" style="white-space: normal;"><span class="f_CodeExample" style="color: #008080;">$db</span><span class="f_CodeExample" style="color: #ff0000;">-&gt;sql_query(</span><span class="f_CodeExample" style="color: #0000ff;">"INSERT INTO `wftp_mysqltable_user` VALUES ('"</span><span class="f_CodeExample" style="color: #ff0000;">.</span><span class="f_CodeExample" style="color: #008080;">$ftp_domain_name</span><span class="f_CodeExample" style="color: #ff0000;">.</span><span class="f_CodeExample" style="color: #0000ff;">"','"</span><span class="f_CodeExample" style="color: #ff0000;">.</span><span class="f_CodeExample" style="color: #008080;">$data</span><span class="f_CodeExample" style="color: #ff0000;">[</span><span class="f_CodeExample" style="color: #0000ff;">'username'</span><span class="f_CodeExample" style="color: #ff0000;">].</span><span class="f_CodeExample" style="color: #0000ff;">"',1,1,'"</span><span class="f_CodeExample" style="color: #ff0000;">.md5(</span><span class="f_CodeExample" style="color: #008080;">$data</span><span class="f_CodeExample" style="color: #ff0000;">[</span><span class="f_CodeExample" style="color: #0000ff;">'new_password'</span><span class="f_CodeExample" style="color: #ff0000;">]).</span><span class="f_CodeExample" style="color: #0000ff;">"',63,0,NULL,0,0,0,0,0,0,0,1,1,1,0,1,1,0,0,0,0,0,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0,0,0,0,0,0,'0',NULL,0,0,0,"</span><span class="f_CodeExample" style="color: #ff0000;">.intval(</span><span class="f_CodeExample" style="color: #008080;">$ftp_upload_limit</span><span class="f_CodeExample" style="color: #ff0000;">).</span><span class="f_CodeExample" style="color: #0000ff;">",0,"</span><span class="f_CodeExample" style="color: #ff0000;">.</span><span class="f_CodeExample" style="color: #008080;">$ftp_maxuoload_size</span><span class="f_CodeExample" style="color: #ff0000;">.</span><span class="f_CodeExample" style="color: #0000ff;">",0,0,0,'');"</span><span class="f_CodeExample" style="color: #ff0000;">);</span></p>
<p class="p_CodeExample" style="white-space: normal;"><span class="f_CodeExample" style="color: #008080;">$mkdir_result</span><span class="f_CodeExample" style="color: #000000;"> </span><span class="f_CodeExample" style="color: #ff0000;">=</span><span class="f_CodeExample" style="color: #000000;"> </span><span class="f_CodeExample" style="color: #ff0000;">@mkdir(</span><span class="f_CodeExample" style="color: #008080;">$ftp_dirpath</span><span class="f_CodeExample" style="color: #ff0000;">);</span></p>
<p class="p_CodeExample" style="white-space: normal;"><span class="f_CodeExample" style="font-weight: bold; color: #0000ff;">if</span><span class="f_CodeExample" style="color: #ff0000;">(</span><span class="f_CodeExample" style="color: #008080;">$mkdir_result</span><span class="f_CodeExample" style="color: #000000;"> </span><span class="f_CodeExample" style="color: #ff0000;">==</span><span class="f_CodeExample" style="color: #000000;"> </span><span class="f_CodeExample" style="font-weight: bold; color: #0000ff;">TRUE</span><span class="f_CodeExample" style="color: #ff0000;">)</span></p>
<p class="p_CodeExample" style="white-space: normal;"><span class="f_CodeExample" style="color: #000000;"> &nbsp; </span><span class="f_CodeExample" style="color: #008080;">$db</span><span class="f_CodeExample" style="color: #ff0000;">-&gt;sql_query(</span><span class="f_CodeExample" style="color: #0000ff;">"INSERT INTO `wftp_mysqltable_dir` VALUES ('"</span><span class="f_CodeExample" style="color: #ff0000;">.</span><span class="f_CodeExample" style="color: #008080;">$ftp_domain_name</span><span class="f_CodeExample" style="color: #ff0000;">.</span><span class="f_CodeExample" style="color: #0000ff;">"','"</span><span class="f_CodeExample" style="color: #ff0000;">.</span><span class="f_CodeExample" style="color: #008080;">$data</span><span class="f_CodeExample" style="color: #ff0000;">[</span><span class="f_CodeExample" style="color: #0000ff;">'username'</span><span class="f_CodeExample" style="color: #ff0000;">].</span><span class="f_CodeExample" style="color: #0000ff;">"','"</span><span class="f_CodeExample" style="color: #ff0000;">.</span><span class="f_CodeExample" style="color: #008080;">$ftp_dirpath</span><span class="f_CodeExample" style="color: #ff0000;">.</span><span class="f_CodeExample" style="color: #0000ff;">"','/',1,1,1,1,1,1,1,1,1,1,1,1);"</span><span class="f_CodeExample" style="color: #ff0000;">);</span></p>
<p class="p_CodeExample" style="white-space: normal;"><span class="f_CodeExample" style="color: #008080;">$db</span><span class="f_CodeExample" style="color: #ff0000;">-&gt;sql_query(</span><span class="f_CodeExample" style="color: #0000ff;">"USE "</span><span class="f_CodeExample" style="color: #ff0000;">.</span><span class="f_CodeExample" style="color: #008080;">$db</span><span class="f_CodeExample" style="color: #ff0000;">-&gt;dbname.</span><span class="f_CodeExample" style="color: #0000ff;">";"</span><span class="f_CodeExample" style="color: #ff0000;">);</span></p>
<p class="p_CodeExample" style="white-space: normal;"><span class="f_CodeExample" style="font-style: italic; color: #008000;">//Wing FTP Server end</span></p>
<p class="p_CodeExample" style="white-space: normal;"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample" style="white-space: normal;"><span class="f_CodeExample">&nbsp;</span></p>
<p><span style="font-size: 11pt; font-weight: bold; color: #ff0000;">Note: </span><span style="font-size: 11pt; font-style: italic; font-weight: bold;">Adding/editing user account by SQL operation is not a recommended method, &nbsp;we suggest you use <a href="lua_language.htm">Lua webservice</a> to make it.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>

<!--ZOOMSTOP-->
</div></div>
<script type="text/javascript"> 
<!-- 
var lastSlashPos = document.URL.lastIndexOf("/") >
document.URL.lastIndexOf("\\") ? document.URL.lastIndexOf("/") :
document.URL.lastIndexOf("\\");
if( document.URL.substring( lastSlashPos + 1, lastSlashPos + 4
).toLowerCase() != "~hh" )
{
    nsrInit();
}
--> 
</script> 
</body>
</html>
